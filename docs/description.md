## Wizard Script

Wizard Script &mdash; интерпретируемый высокоуровневый язык программирования.
Поддерживает структурную и функциональную парадигмы, обладает строгой
динамической типизацией и менеджером памяти, основанным на подсчёте ссылок.

### Исходники

Файлы исходного кода должны быть в кодировке ASCII.

### Ключевые слова

16 ключевых слов:

    and break continue do else end if include lambda new not null or return then while

### Типы

Типизация: строгая динамическая.

Менеджмент памяти: подсчёт ссылок без сборщика мусора, слабых ссылок нет.

#### Нулевой тип

Название: null.

Тип: беззнаковый целочисленный, 1 байт; всегда равен нулю.

Копирование: по значению.

Хранение: на стеке.

Определение: `"null"`.

#### Числа

Название: number.

Тип: с плавающей запятой, 8 байт.

Копирование: по значению.

Хранение: на стеке.

Определение: `/\d+(\.\d+)?/`.

#### Массивы

Название: array.

Тип: динамический массив.

Копирование: по ссылке.

Хранение:

* ссылки &mdash; на стеке;
* значения &mdash; в куче.

Определение: `"[", [expression, {",", expression}], "]"`.

Доступ к элементам: `expression, "[", expression, "]"`.

#### Строки

Строками являются массивы, хранящие коды символов. Используется кодировка ASCII.

Определение: `/'(\\.|[^'])*'/`.

#### Лямбда

Название: lambda.

Тип:замыкание.

Копирование: по ссылке.

Хранение:

* ссылки &mdash; на стеке;
* значения &mdash; в куче.

Определение:

    "lambda", "(", [identifier, {",", identifier}], ")",
        statement,
        {statement},
    "end"

Вызов лямбды: `expression, "(", [expression, {",", expression}], ")"`.

При вызове соответствие числа аргументов числу параметров не проверяется. Всем
параметрам, неполучившим значение, присваивается значение `null`. В теле лямбды
определён массив `arguments`, содержащий все аргументы.

Возврат из лямбды: `"return", [expression], ";"`. Так же последнее вычисленное
значение &mdash; неявный возврат.

#### Логические значения

В качестве ложного логического значения принимаются значение `null` и число 0.

В качестве истинного логического значения принимаются числа, отличные от 0, и
любые ссылки на массивы и лямбды.

### Операции

Перечислены в порядке убывания приоритета.

Приоритет | Операция | Описание | Ассоциативность | Типы | Особенности
--- | --- | --- | --- | --- | ---
1 | `[]` | доступ к элементам массива | левая | массивы | &mdash;
2 | `new` | объявление переменной | &mdash; | идентификаторы | &mdash;
2 | `-` | унарный минус | правая | числа | &mdash;
2 | `not` | логическое отрицание | правая | все | &mdash;
3 | `*` | умножение | левая | числа | &mdash;
3 | `/` | деление | левая | числа | &mdash;
4 | `+` | сложение | левая | числа | &mdash;
4 | `-` | вычитание | левая | числа | &mdash;
5 | `<` | меньше | левая | числа | &mdash;
5 | `<=` | меньше или равно | левая | числа | &mdash;
5 | `>` | больше | левая | числа | &mdash;
5 | `>=` | больше или равно | левая | числа | &mdash;
6 | `==` | равенство | левая | все | при сравнении массивов сравнивает ссылки
6 | `/=` | неравенство | левая | все | при сравнении массивов сравнивает ссылки
7 | `and` | логическое и | левая | все | ленивая
8 | `or` | логическое или | левая | все | ленивая
9 | `=` | присваивание | правая | все | слева допускаются переменные и элементы массивов

### Управляющие конструкции

Могут использоваться как выражения. Значением при этом является последнее
вычисленное значение в теле конструкции.

#### Условие

    "if", expression, "then",
        statement,
        {statement},
    {"else", "if", expression, "then",
        statement,
        {statement}},
    ["else",
        statement,
        {statement}],
    "end"

#### Цикл

    "while", expression, "do",
        statement,
        {statement},
    "end"

Переход к следующей итерации цикла: `continue`.

Прерывание цикла: `break`.

### Модульность

Тип: включением кода как текста.

Использование: `"include", expression`.

В качестве `expression` может использоваться лишь определение строки. Строка
должна содержать относительный путь к файлу с кодом.

Файлы включаются рекурсивно, и каждый только один раз.

### Рантайм

* модуль `lang`:
    * `GetType(value)`;
    * `ToString(number)`;
    * модуль `lang.array`:
        * `GetLength()`;
        * `Insert(array, index, element)`;
        * `Remove(array, index)`;
* модуль `system`:
    * `Exit(exit_code)`;
    * модуль `system.io`:
        * `Read(stream)`;
        * `Write(stream, byte)`;
        * `Open(path, mode)`;
        * `Close(stream)`;
* модуль `maths`:
    * `Sin(number)`;
    * `Cos(number)`;
    * `Tg(number)`;
    * `Arcsin(number)`;
    * `Arccos(number)`;
    * `Arctg(number)`;
    * `SquareRoot(number)`;
    * `Power(number)`;
    * `Exp(number)`;
    * `Ln(number)`;
    * `Integral(number)`;
    * `GetRandom()`;

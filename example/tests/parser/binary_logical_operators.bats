load "../common/test_json_output"

declare -gra OPTIONS=("--stdin")

@test "parser: conjunction, with an one conjunction sign" {
	declare -r INPUT="x and y"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":6,"type":"sequence"},{"children":[{"children":[{"offset":6,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}

@test "parser: conjunction, with some (two) conjunction signs" {
	declare -r INPUT="x and y and z"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":6,"type":"sequence"},{"children":[{"children":[{"offset":6,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"children":[{"children":[{"offset":8,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":12,"type":"sequence"},{"children":[{"children":[{"offset":12,"type":"base_identifier","value":"z"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"offset":13,"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}

@test "parser: conjunction, with some (three) conjunction signs" {
	declare -r INPUT="x and y and z and w"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":6,"type":"sequence"},{"children":[{"children":[{"offset":6,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":8,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"children":[{"children":[{"offset":8,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":12,"type":"sequence"},{"children":[{"children":[{"offset":12,"type":"base_identifier","value":"z"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":14,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":14,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":14,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":14,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"children":[{"children":[{"offset":14,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":18,"type":"sequence"},{"children":[{"children":[{"offset":18,"type":"base_identifier","value":"w"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"equality"}],"type":"sequence"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"offset":19,"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}

@test "parser: disjunction, with an one disjunction sign" {
	declare -r INPUT="x or y"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":5,"type":"sequence"},{"children":[{"children":[{"offset":5,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"offset":6,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}

@test "parser: disjunction, with some (two) disjunction signs" {
	declare -r INPUT="x or y or z"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":5,"type":"sequence"},{"children":[{"children":[{"offset":5,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"children":[{"children":[{"offset":7,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":10,"type":"sequence"},{"children":[{"children":[{"offset":10,"type":"base_identifier","value":"z"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"offset":11,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}

@test "parser: disjunction, with some (three) disjunction signs" {
	declare -r INPUT="x or y or z or w"
	declare -r OUTPUT='{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":0,"type":"sequence"},{"children":[{"children":[{"offset":0,"type":"base_identifier","value":"x"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":2,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"},{"children":[{"children":[{"offset":2,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":5,"type":"sequence"},{"children":[{"children":[{"offset":5,"type":"base_identifier","value":"y"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":7,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"children":[{"children":[{"offset":7,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":10,"type":"sequence"},{"children":[{"children":[{"offset":10,"type":"base_identifier","value":"z"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":12,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":12,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":12,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":12,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":12,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"children":[{"children":[{"offset":12,"type":"nothing"},{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"children":[{"offset":15,"type":"sequence"},{"children":[{"children":[{"offset":15,"type":"base_identifier","value":"w"}],"type":"identifier"}],"type":"atom"}],"type":"sequence"}],"type":"unary"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"product"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"sum"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"comparison"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"equality"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"conjunction"}],"type":"sequence"},{"offset":16,"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"sequence"}],"type":"disjunction"}'
	test_json_output
}
